

What can go wrong with \textit{standard} MPC?

- No feasibility guarantee, the problem may not have a solution

- No stability guarantee, trajectories may not converge to  origin

\begin{sstTitleBox}[ForestGreen]{\center\textbf{\large
			MPC Mathematical Formulation
		}
		% small text
	}

	V1
	\begin{sstFrame}[ForestGreen]
		\small
		\color{white}
		\[
			J^\star(x(k))= \min\sum_{i=0}^{N-1}
			x_i^\top Q x_i + u_i^\top R u_i\]
	\end{sstFrame}

	\[\begin{aligned}
			\mathrm{subj.\ to }\   x_{i+1} & = Ax_i + Bu_i \\
			x_0                            & = x(k)
			\quad x_i \in \mathcal{X},
			\quad u_i \in \mathcal{U}
		\end{aligned}\]

	%WARN: Solution MPC Terminal Cost L6.p27

\end{sstTitleBox}


%TODO: Lyapunov Stability extend with L6.p29 invariant set and L.6.30 Theorem, MPC Proof 1,2


\begin{sstTitleBox}
	{	Stability of MPC - Main Result}
	\begin{theorem}
		The closed-loop system under the MPC control law $u_0^\star(x)$
		is asymptotically stable and the set $\mathcal{X}_f$
		is positive invariant for the system
		$x(k+1) = Ax(k) + Bu_0^\star(x(k))$
		under the following assumptions:

		1. Stage cost is positive definite, i.e. it is strictly positive and only zero at
		the origin

		2. Terminal set is \textbf{invariant}
		under the local control law $\kappa_f(x_i)$:

		\[
			x_{i+1} = Ax_i + B\kappa_f(x_i) \in \mathcal{X}_f
			\text\forall x_i \in \mathcal{X}_f
		\]

		All state and input \textbf{constraints are satisfied} in $\mathcal{X}_f$:

		\[
			\mathcal{X}_f \in X, \kappa_f(x_i) \in U
			\text\forall x_i \in \mathcal{X}_f
		\]

		3. Terminal cost is a continuous \textbf{Lyapunov function}
		in the terminal set $\mathcal{X}_f$ and satisfies:
		\[
			I_f(x_{i+1}) - I_f(x_i) \leq
			- I(x_i, \kappa_f(x_i)) \quad
			\forall x_i \in \mathcal{X}_f
		\]
		%WARN: MPC Main Result, finish, Proof ?
	\end{theorem}
\end{sstTitleBox}

%HACK: choice of terminal set (compare with cftoc)

%TODO: Conclusion text, extension to nonlinear MPC (easy)

\begin{sstFrame}[ForestGreen!20]
	% \center

	\textbf{Finite-horizon MPC may not satisfy constraints for all time!}

	\textbf{Finite-horizon MPC may not be stable!}

	-	An infinite-horizon provides stability and invariance.

	-	Infinite-horizon \textit{faked} by forcing final state
	into an invariant set for which there exists
	invariance-inducing controller,
	whose infinite-horizon cost can be expressed in closed-form.

	-	Extends to non-linear systems, but compute sets is difficult!
\end{sstFrame}
